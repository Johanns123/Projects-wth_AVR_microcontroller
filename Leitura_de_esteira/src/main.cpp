/* ===========================================================================

	Programa��o Avan�ada em C++
	Programa��o orientada a eventos

    ARQUIVO main.cpp
    
    MCU:   Atmega328p
    Clock: 16MHz Cristal Externo

    Compilador: Microchip Studio 7.0.2542
    Autor: Dr. Eng. Wagner Rambo
    Data de cria��o: Abril de 2022
    �ltima atualiza��o: 16/04/2022

============================================================================ */


// ============================================================================
// --- Bibliotecas ---
#include "readEdge.hpp"
#include <avr/interrupt.h>

// ============================================================================
// --- Mapeamento de Hardware ---
#define   BT1  PORTB0
#define   BT2  PORTB1


// ============================================================================
// --- Declara��o de Objetos ---
readEdge infrared_sensor(&DDRB, &PINB, BT1,false);


// ============================================================================
// --- Prot�tipo das Fun��es ---
void pressed1();
void released1();

// ============================================================================
// ---  Variaveis globais ---
uint8_t contador = 0;

// ============================================================================
// --- Interrupcoes ---
ISR(PCINT0_vect)
{
  infrared_sensor.run();
}

 
// ============================================================================
// --- Fun��o Principal ---
int main(void)
{
  DDRD    = 0xff;

  PCICR  |= (1<<PCIE0);
  PCMSK0 |= (1<<PCINT0) | (1<<PCINT1);

  infrared_sensor.firstEdge(pressed1);
  
  sei();
  while(1)
  {
    PORTD = contador;
  } //end while
  
} //end main



// ============================================================================
// --- Desenvolvimento das Fun��es ---


// ============================================================================
// --- pressed1 ---
void pressed1()
{
	contador++;
}


// ============================================================================
// --- released1 ---
void released1()
{


	
}

/* ============================================================================

                                       _
                                      / \
                                     |oo >      <-- (Woww, advanced application!)
                                     _\=/_
                    ___         #   /  _  \   #
                   /<> \         \\//|/.\|\\//
                 _|_____|_        \/  \_/  \/
                | | === | |          |\ /|
                |_|  0  |_|          \_ _/
                 ||  0  ||           | | |
                 ||__*__||           | | |
                |* \___/ *|          []|[]
                /=\ /=\ /=\          | | |
________________[_]_[_]_[_]_________/_]_[_\_______________________________


============================================================================ */
/* --- Final do Arquivo main.cpp --- */